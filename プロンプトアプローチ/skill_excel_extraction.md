# Excel プレイヤー情報抽出スキル

アップロードされた Excel ファイルからプレイヤー情報を正確に抽出する手順です。

---

## 1. ヘッダー行の検出

Excel の **先頭15行以内** をスキャンし、以下のキーワードを最も多く含む行をヘッダー行と判定します。

**検出キーワード:**
サービス名、プレイヤー名、ブランド名、企業名、会社名、事業者名、調査票用No、調査対象

- 複数行が同スコアの場合は、より上にある行を採用
- どの行にもキーワードがない場合 → ユーザーに「ヘッダー行はどの行ですか？」と確認

---

## 2. 抽出対象カラム（3つの必須列）

ヘッダー行の列名を以下のパターンで照合し、自動マッピングします。

### プレイヤー名列（最優先で検出）
完全一致: `サービス名` `プレイヤー名` `ブランド名` `企業名` `会社名`
部分一致: サービス名、プレイヤー名、ブランド名

### 公式URL列
完全一致: `URL` `公式URL` `公式サイト` `ホームページ` `HP`
部分一致: URL、公式URL、公式サイト、ホームページ、HP

### 運営会社列
完全一致: `事業者名` `運営会社` `運営元`
部分一致: 事業者名、事業者、運営会社、運営元

**マッピングできない列がある場合** → ユーザーに「この列はどれに該当しますか？」と確認

---

## 3. データ読み取りルール

- ヘッダー行の次の行からデータ開始
- プレイヤー名が空の行はスキップ
- プレイヤー名列が検出できない場合は列Aをフォールバック使用（数字のみの行はスキップ）
- 上記3列以外のカラムも「その他情報」として保持

---

## 4. 出力形式

### テーブル形式（必須）

```
| # | プレイヤー名 | 公式URL | 運営会社 | その他 |
|---|---|---|---|---|
| 1 | サービスA | https://... | 株式会社X | カテゴリ: 年会費無料 |
```

### サマリー（必須）
- 「全 **N** 件抽出しました」
- ヘッダー行の位置（例: 3行目）
- 検出された列名一覧

### GPTs の場合（追加）
抽出結果を **Excel ファイル (.xlsx)** として Code Interpreter で生成し、ダウンロードリンクを提供してください。列は以下の順序:
1. No（連番）
2. プレイヤー名
3. 公式URL
4. 運営会社
5. その他カラム（元の列名を維持）

### Gem の場合（追加）
TSV 形式（タブ区切り）で出力し、「Google Sheets にそのまま貼り付けできます」と案内してください。
